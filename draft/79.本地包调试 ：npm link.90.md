# 79.本地包调试 ：npm link.90
## <a name="index"></a> 目录
- [引子](#start)
- [title1](#title1)
  - [title11](#title11)
- [参考资料](#reference)


## <a name="start"></a> 引子
再次碰到调试 npm 本地包的情况，一时想不起来，看了下文档，实际操作了一下，发现了一些文档上没明写的东西。

## <a name="title1"></a> 介绍


### <a name="title11"></a> 实践
基于上面的文档，结合实际的操作，对照看下是对应产生效果。
### 运行环境
- 项目是基于 webpack 简单配置，本地运行的 server 。
- node 使用 nvm 管理的。
- 项目已引用了包，需在基础上进行修改调试。
- 系统是 Mac 。

### 操作
首先在包根目录下面进行了 `npm link` 的操作，出现下面的提示：

![79-link][url-local-1]

到对应的目录下，发现生成了提示中所说的文件，就是文档中所说对应全局的一个符号链接（symlink）：

![79-result][url-local-2]

试着改了一下本地的源文件，发现全局包里面的对应的文件内容也跟着变化，感觉就像是源文件的快捷访问方式。

然后到项目中执行 npm link package 指令，出现了下面的提示：

![79-link-package][url-local-3]

到依赖 node_modules 下发现对应的依赖包已经发生了变化：

![79-link-module][url-local-4]

这里的包跟全局那个生成的包是一样的，包更新了，本地看没什么效果，原因是本地的 sever 有缓存，需要重新启动一下。

注意这个文件的 icon 多了一个箭头的标记。

重启服务后，到源库修改源码，发现项目 node_modules 下同步了修改的内容，webpack 也检测到变化，自动刷新，这个感觉很方便。

修改好后，想要恢复到原本的包，解除 link 该怎么做？很奇怪，在 npm 官方文档上没找到说明。

### 解除 link
```
npm unlink --no-save package && npm install
```
unlink 其实是 uninstall 的别名，实质上也是删除了包。


<div align="right"><a href="#index">Back to top :arrow_up:</a></div>


## <a name="reference"></a> 参考资料
- [npm-link][url-docs-1]
- [Understanding npm-link][url-article-1]
- [NPM Linking and Unlinking][url-article-2]


[url-docs-1]:https://docs.npmjs.com/cli-commands/link.html
[url-article-1]:https://medium.com/dailyjs/how-to-use-npm-link-7375b6219557
[url-article-2]:https://dev.to/erinbush/npm-linking-and-unlinking-2h1g

[url-local-1]:../images/79/npm-link.png
[url-local-2]:../images/79/link-result.png
[url-local-3]:../images/79/link-package.png
[url-local-4]:../images/79/link-module.png

<details>
<summary>:wastebasket:</summary>

最近听了杨照老师《史记》音频，对秦始皇的坑儒有了不一样的认知。

在《史记》里面，坑儒是指秦始皇查出，那些说能帮助他长生不死的方士，都是骗他的，一下子查出了 460 人，都坑杀了。而且还让天下人知道这个事情。

</details>
